# 71、Qt的D指针（`d_ptr`）与Q指针（`q_ptr`）

 
    D指针和Q指针是 Qt 为解决 “库的长期维护与兼容性” 而设计的模式，核心价值在于：分离接口与实现，保证二进制兼容，隐藏内部细节。

D指针   

    PIMPL模式，指向一个包含所有数据的私有数据结构体。
    - 私有的结构体可以随意改变，而不需要重新编译整个工程项目
    - 隐藏实现细节
    - 头文件中没有任何实现细节，可以作为API使用
    - 原本在头文件的实现部分转移到源文件，所以编译速度有所提高

Q指针

    私有的结构体中储存一个指向公有类的Q指针。

总结

    - Qt中的一个类常用一个PrivateXXX类来处理内部逻辑，使得内部逻辑与外部接口分开，这个PrivateXXX对象通过D指针来访问；在PrivateXXX中有需要引用Owner的内容，通过Q指针来访问。
    - 由于D和Q指针是从基类继承下来的，子类中由于继承导致类型发生变化，需要通过`static_cast`类型转化，所以`DPTR()`与`QPTR()`宏定义实现了转换。
